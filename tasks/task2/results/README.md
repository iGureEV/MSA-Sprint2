# Задание 2 - Реализация новых сервисов

## Автор
Гуреев Евгений 

## Описание

Паттерн Strangler Fig подразумевает вынесение сначала наименее связанных и наименее сложных сервисов.
В задании же говорится вынести самый связанный и самый сложный модуль.

Нативные вызовы между сервисами монолита теперь заменены сетевыми запросами к контроллерам монолита, что несколько ухудшает производительность.
Желательно следующим шагом заменить сетевые вызовы взаимодействием через Kafka или NATS.

---
---

## Реализация

- **Нативный Node.js** (без фреймворков)
- **Интерфейс gRPC** для внешних клиентов
- **Интеграция** с монолитом через REST вызовы
- **Публикация событий Kafka** для сервиса истории бронирований
- **Контейнеризация Docker** с использованием образа Node.js 24-alpine

## Сервисы

### Сервис бронирования
- Интерфейс gRPC для бронирования
- Интегрируется с монолитом по REST API
- Публикация события бронирования в Kafka

### Сервис истории бронирований
- Подписка на событие бронирования в Kafka
- Сохранение историю бронирований


## Начало работы

1. Убедитесь, что сеть `hotelio-net` существует:
   ```bash
   docker network create hotelio-net
   ```

2. Запустите все сервисы:
   ```bash
   docker-compose up --build
   ```

3. Сервисы будут доступны:
   - Сервис бронирования (gRPC): localhost:9090
   - Монолит: localhost:8084

## Переменные окружения

### Сервис бронирования
- `MONOLITH_URL` - Адрес монолита (по умолчанию: http://monolith:8080)
- `KAFKA_BROKERS` - Адреса Kafka (по умолчанию: localhost:9092)
- `GRPC_PORT` - Порт gRPC (по умолчанию: 9090)
- `DB_HOST` - Хост БД (по умолчанию: localhost)
- `DB_PORT` - Порт БД (по умолчанию: 5432)
- `DB_NAME` - Имя БД (по умолчанию: booking_db)
- `DB_USER` - Пользователь БД (по умолчанию: postgres)
- `DB_PASSWORD` - Пароль БД (по умолчанию: postgres)

### Сервис истории бронирований
- `KAFKA_BROKERS` - Адреса Kafka (по умолчанию: localhost:9092)
- `KAFKA_GROUP_ID` - Группа в Kafka (по умолчанию: booking-history-group)
- `KAFKA_TOPIC` - Топик Kafka (по умолчанию: bookings)
- `DB_HOST` - Хост БД (по умолчанию: localhost)
- `DB_PORT` - Порт БД (по умолчанию: 5432)
- `DB_NAME` - Имя БД (по умолчанию: booking_history_db)
- `DB_USER` - Пользователь БД (по умолчанию: postgres)
- `DB_PASSWORD` - Пароль БД (по умолчанию: postgres)

